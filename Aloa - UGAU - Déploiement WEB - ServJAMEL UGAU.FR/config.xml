<?xml version='1.1' encoding='UTF-8'?>
<flow-definition plugin="workflow-job@2.29">
  <actions>
    <org.jenkinsci.plugins.pipeline.modeldefinition.actions.DeclarativeJobAction plugin="pipeline-model-definition@1.3.2"/>
    <org.jenkinsci.plugins.pipeline.modeldefinition.actions.DeclarativeJobPropertyTrackerAction plugin="pipeline-model-definition@1.3.2">
      <jobProperties/>
      <triggers/>
      <parameters/>
      <options/>
    </org.jenkinsci.plugins.pipeline.modeldefinition.actions.DeclarativeJobPropertyTrackerAction>
  </actions>
  <description></description>
  <keepDependencies>false</keepDependencies>
  <properties>
    <com.sonyericsson.jenkins.plugins.bfa.model.ScannerJobProperty plugin="build-failure-analyzer@1.25.1">
      <doNotScan>false</doNotScan>
    </com.sonyericsson.jenkins.plugins.bfa.model.ScannerJobProperty>
    <org.jenkinsci.plugins.gogs.GogsProjectProperty plugin="gogs-webhook@1.0.14">
      <gogsSecret>Palmier-10</gogsSecret>
      <gogsUsePayload>false</gogsUsePayload>
    </org.jenkinsci.plugins.gogs.GogsProjectProperty>
  </properties>
  <definition class="org.jenkinsci.plugins.workflow.cps.CpsFlowDefinition" plugin="workflow-cps@2.60">
    <script>#!/usr/bin/env groovy
pipeline {
    agent any
    stages {
        stage(&quot;PREREQUIS&quot;) {
            steps {
                sh &apos;&apos;&apos;#!/bin/bash
                ssh aloa@147.135.130.166 &apos;cd /var/www/ugau_fr/ionic_admin; git fetch origin master &amp;&amp; git reset --hard origin/master; npm install&apos;
                &apos;&apos;&apos;
            }
        }
        stage(&quot;BUILD&quot;) {
            steps {
                sh &apos;&apos;&apos;#!/bin/bash
                ssh aloa@147.135.130.166 &apos;cd /var/www/ugau_fr/ionic_admin; /usr/bin/cross-env ENV=&apos;dev&apos; ionic cordova build browser --prod&apos;
                &apos;&apos;&apos;
            }
        }
        stage(&quot;COPY&quot;) {
            steps {
                sh &apos;&apos;&apos;#!/bin/bash
                ssh aloa@147.135.130.166 &apos;cd /var/www/ugau_fr/ionic_admin; cp -r platforms/browser/www/* /var/www/ugau_fr/admin/&apos;
                &apos;&apos;&apos;
            }
        }
        stage(&quot;CHOWN CHMOD&quot;) {
            steps {
                sh &apos;&apos;&apos;#!/bin/bash
                ssh root@147.135.130.166 &apos;cd /var/www/ugau_fr; chown aloa:www-data . -R&apos;
                
echo &quot;From: jenkins@dev.aloa.ovh&quot; &gt; ./mail_auto;
echo &quot;To: timothee@aloa-informatique.com&quot; &gt;&gt; ./mail_auto;
echo &quot;Cc: contact@france-signalisations.fr&quot; &gt;&gt; ./mail_auto;
echo &quot;Subject: Generation de l&apos;administration PROD pour l&apos;application UGAU : PRODUCTION&quot; &gt;&gt; ./mail_auto;
echo &quot;&quot; &gt;&gt; ./mail_auto;
echo &quot;Bonjour,\n\nUne nouvelle version de l&apos;administration UGAU pour DEVELOPPEMENT vient d&apos;être générée à l&apos;adresse https://ugau.fr\nAttention, il est possible que l&apos;administration ne soit pas fonctionnelle après installation : Il faut effacer les données de le cache dans le navigateur\n\nCordialement,\n\nPs: Ne pas répondre sur cette adresse email.&quot; &gt;&gt; ./mail_auto;
cat ./mail_auto | /usr/sbin/sendmail -t;
rm ./mail_auto
                &apos;&apos;&apos;
            }
        }
    }
}</script>
    <sandbox>false</sandbox>
  </definition>
  <triggers/>
  <disabled>false</disabled>
</flow-definition>